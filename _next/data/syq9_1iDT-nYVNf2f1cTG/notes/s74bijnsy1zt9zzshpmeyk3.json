{"pageProps":{"note":{"id":"s74bijnsy1zt9zzshpmeyk3","title":"3 Build Image Dengan Docker","desc":"","updated":1646862683999,"created":1646862196227,"custom":{},"fname":"handbook.golang.3-build-image-dengan-docker","type":"note","vault":{"fsPath":"vault"},"contentHash":"dc62fafc045729e4ee0109a3f1c5e4ea","links":[{"type":"wiki","from":{"fname":"handbook.golang.3-build-image-dengan-docker","id":"s74bijnsy1zt9zzshpmeyk3","vaultName":"vault"},"value":"tags.go","alias":"#go","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":4,"offset":4},"indent":[]},"xvault":false,"to":{"fname":"tags.go"}},{"type":"wiki","from":{"fname":"handbook.golang.3-build-image-dengan-docker","id":"s74bijnsy1zt9zzshpmeyk3","vaultName":"vault"},"value":"tags.docker","alias":"#docker","position":{"start":{"line":2,"column":5,"offset":5},"end":{"line":2,"column":12,"offset":12},"indent":[]},"xvault":false,"to":{"fname":"tags.docker"}}],"anchors":{},"children":[],"parent":"3e9942id79hw89ncudt79ok","data":{}},"body":"<h1 id=\"3-build-image-dengan-docker\">3 Build Image Dengan Docker<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#3-build-image-dengan-docker\"></a></h1>\n<p><a class=\"color-tag\" style=\"--tag-color: #a8a495;\" href=\"/sotoy/notes/1l18nvi2v8de3tka75ibojn\">#go</a> <a class=\"color-tag\" style=\"--tag-color: #7ef4cc;\" href=\"/sotoy/notes/6y00oq5e6tpq0g68u34frr7\">#docker</a></p>\n<pre class=\"language-dockerfile\"><code class=\"language-Dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> golang:1.17 <span class=\"token keyword\">as</span> build</span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> /app</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ADD</span> . .</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -ldflags <span class=\"token string\">'-extldflags \"-static\"'</span> -o main .</span>\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [<span class=\"token string\">\"go\"</span>, <span class=\"token string\">\"run\"</span>, <span class=\"token string\">\"main.go\"</span>]</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">FROM</span> gcr.io/distroless/base-debian10 <span class=\"token keyword\">as</span> production</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> <span class=\"token options\"><span class=\"token property\">--from</span><span class=\"token punctuation\">=</span><span class=\"token string\">build</span></span> /app/main /</span>\n<span class=\"token instruction\"><span class=\"token keyword\">EXPOSE</span> 8080</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [<span class=\"token string\">\"/main\"</span>]</span>\n</code></pre>\n<ul>\n<li>\n<p><code>FROM golang:1.17 as build</code></p>\n<p>build akan dialankan pada golang versi1.17, versi bisa disesuaikan dengan versi golang saat ini.</p>\n</li>\n<li>\n<p><code>WORKDIR /app</code></p>\n<p>Buat folder /app sebagai working directory </p>\n</li>\n<li>\n<p><code>ADD . .</code></p>\n<p>copy source code kita dengan <code>ADD . .</code></p>\n</li>\n<li>\n<p><code>RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -ldflags '-extldflags \"-static\"' -o main .</code></p>\n<p>build source code hingga menjadi binary dan filenya nanti akan bernama main</p>\n</li>\n<li>\n<p><code>FROM gcr.io/distroless/base-debian10 as production</code></p>\n<p>selanjutnya ambil image minimal menggunakan distroless base image.\ninfo selanjutnya bisa dibaca disini <a href=\"https://github.com/GoogleContainerTools/distroless\">https://github.com/GoogleContainerTools/distroless</a>.</p>\n</li>\n<li>\n<p><code>COPY --from=build /app/main /</code></p>\n<p>lalu copy binary apliasi yang sudah dibuat sebelumnya.</p>\n</li>\n<li>\n<p><code>COPY --from=build /app/main /</code></p>\n<p>copy binary dari build stage ke root</p>\n</li>\n<li>\n<p><code>EXPOSE 8080</code></p>\n<p>expose 8080</p>\n</li>\n<li>\n<p><code>CMD [\"/main\"]</code></p>\n<p>runing command <code>/main</code></p>\n</li>\n</ul>","noteIndex":{"id":"oqxmejlafk9x8rj9t5hya5z","title":"Hi ðŸ‘‹","desc":"","updated":1721116613997,"created":1646842475821,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"64c62caa2f0c02c2d68a5a2d826cc01e","links":[],"anchors":{"welcome-to-sotoy":{"type":"header","text":"Welcome to Sotoy","value":"welcome-to-sotoy","line":8,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":12,"column":0,"depth":2}},"children":["spfwom01chbihki1twghclf","bsv930j2j6qlih60c7eu7wh","ohf85tu5nw2b8ewx6cetsmp","u3lhhpriar8wgcjw8svapha","tvdcga33h6hi7fxd9cwqd66"],"parent":null,"data":{},"body":"\n# Welcome to Sotoy\n\nThis is the root of your dendron vault. If you decide to publish your entire vault, this will be your landing page. You are free to customize any part of this page except the frontmatter on top.\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"dendronVersion":"0.83.0","vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"seeds":{"dendron.templates":{}},"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":true,"siteRootDir":"docs","seo":{"title":"Sotoy","description":"Personal knowledge space about anything I learn. Notes, knowledge, and ideas from me.","author":"Zeihan Aulia","twitter":"zeihanaulia","image":{"url":"https://pbs.twimg.com/profile_images/502375255256485888/1UYtt7PT_400x400.jpeg","alt":"Software Engineer, "}},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","assetsPrefix":"/sotoy","siteUrl":"https://zeihanaulia.github.io","duplicateNoteBehavior":{"action":"useVault","payload":["vault-private","vault","dendron.templates"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}